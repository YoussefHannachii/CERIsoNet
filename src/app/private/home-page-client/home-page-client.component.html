<app-notification-bar (closeNotifBarEvent)="recieveNotifCloseEvent($event)" *ngIf="notificationExists"></app-notification-bar>
<app-header></app-header>

<div class="container mx-auto border border-dark shadow p-3 mt-2 mb-5 bg-body rounded">
    <!-- Another div at the top -->
    <div class="d-flex justify-content-between">
      <div class="child-div col-md-8">
        <div class="input-group  mb-3 shadow">
            <input type="text" class="form-control" placeholder="Rechercher un message. exp: id,#hashtag" aria-label="Username" aria-describedby="basic-addon1">
            <span class="input-group-text" id="basic-addon1" (click)="log()">@</span>
        </div>
      </div>
      <div class="child-div col-md-3 mb-2">
        <div class="form-floating">
            <select class="form-select custom-select shadow" id="floatingSelect" aria-label="Floating label select example" (click)="log()" [(ngModel)]="methodeDeTri">
              <option selected disabled>Trier Par</option>
              <option value="LikeDown">Les plus likés</option>
              <option value="LikeUp">Les moins likés</option>
              <option value="DateDown">Les plus récents</option>
              <option value="DateUp">Les plus anciens</option>
            </select>
            <label for="floatingSelect">Trier Par</label>
          </div>
      </div>
      <!-- Add more child divs as needed -->
    </div>
    <!-- Cards Section -->
    <div *ngFor="let message of listMessages | paginate : { itemsPerPage:messageParPage, currentPage:page}" id="element-card" class="card col-12 mb-3 text-center" style="max-width: 100%;" (click)="log()">
      <div class="card-header text-centre">
        {{message._id}}
      </div>
      <div class="row g-0">
        <div class="col-md-4">
          <img src="{{ message.image.url }}" class="img-fluid rounded-start" alt="{{message.image.title}}">
          <div *ngFor="let hashtag of message.hashtags" class="badge bg-secondary text-wrap" style="width: 6rem;">
              {{hashtag}}
            </div>
        </div>
        <div class="col-md-8">
          <!-- Retirez la classe col-md-8 pour permettre au texte de prendre toute la largeur -->
          <div class="card-body">
            <h5 class="card-title">{{ message.body }}</h5>
            <div *ngFor="let comment of message.comments | slice:0:3; let last = last">
              <p class="text-bold"></p>
              <p>{{ comment.commentedBy}} : {{ comment.text }}</p>
              <a *ngIf="last && message.comments.length > 3">({{message.comments.length-3}}) Autres commentaires ...</a>
            </div>
            
            
            <!-- Message alternatif si items est vide -->
            <div *ngIf="message.comments.length === 0">
              Aucun commentaire. 
            </div>
          </div>
        </div>
      </div>
      <div class="card-footer text-body-secondary d-flex justify-content-between">
        <div>
          <button type="button" class="btn btn-outline-secondary">Like</button>
          <button type="button" class="btn btn-outline-secondary">Partager</button>
        </div>
        <div class="ml-auto">
          
          <p>Partagé le : {{message.date}} {{message.hour}}</p>
        </div>
      </div>
    </div>
    
    <div class="d-flex justify-content-between">
        <div class="child-div col-md-4  ">
          <div class="form-floating">
            <select class="form-select custom-select shadow" id="floatingSelect" aria-label="Floating label select example" (onChange)="log()" [(ngModel)]="messageParPage">
              <option value="10" selected disabled>{{messageParPage}}</option>
              <option value="20">20</option>
              <option value="30">30</option>
            </select>
            <label for="floatingSelect">Nombre de messages affichés</label>
          </div>
        </div>
        <div class="child-div col-md-4 mb-2">
            <pagination-controls (pageChange)="page= $event"
                                  previousLabel="Précedent"
                                  nextLabel="Suivant"
                                  screenReaderCurrentLabel="Vous etes sur la page">
            </pagination-controls>
        </div>
      </div>
  </div>
  